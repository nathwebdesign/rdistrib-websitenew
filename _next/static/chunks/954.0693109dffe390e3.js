(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[954],{4954:function(r,e,t){"use strict";t.r(e),t.d(e,{default:function(){return c}});var n=t(7437),o=t(2265),i=t(7691),a=t.n(i);function c(r){let{depart:e,arrivee:t,departCoords:i,arriveeCoords:c,poles:u}=r,s=(0,o.useRef)(null),l=(0,o.useRef)(null),p=(0,o.useRef)([]),d=(0,o.useRef)([]),h=(0,o.useRef)(null),f=(0,o.useRef)(!1);return(0,o.useEffect)(()=>{if(!f.current&&h.current)try{s.current=a().map(h.current,{center:[46.603354,1.888334],zoom:6,zoomControl:!0,attributionControl:!0}),a().tileLayer("https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",{attribution:"\xa9 OpenStreetMap contributors \xa9 CARTO",maxZoom:19,minZoom:3}).addTo(s.current),Object.entries(u).forEach(r=>{let[e,t]=r,n=a().divIcon({html:'\n              <div style="position: relative;">\n                <div style="background-color: #6366f1; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; box-shadow: 0 2px 6px rgba(0,0,0,0.3); border: 2px solid white; font-size: 14px;">\n                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>\n                    <polyline points="9 22 9 12 15 12 15 22"></polyline>\n                  </svg>\n                </div>\n              </div>\n            ',className:"",iconSize:[30,30],iconAnchor:[15,15],popupAnchor:[0,-15]}),o=a().marker(t,{icon:n}).addTo(s.current);o.bindPopup('<div style="font-weight: bold; font-size: 14px;">\uD83C\uDFED P\xf4le '.concat(e,"</div>"),{className:"custom-popup"}),d.current.push(o)}),f.current=!0}catch(r){console.error("[Map] Erreur initialisation carte:",r)}return()=>{s.current&&f.current&&(s.current.remove(),s.current=null,f.current=!1)}},[]),(0,o.useEffect)(()=>{if(!s.current)return;l.current&&(s.current.removeLayer(l.current),l.current=null),p.current.forEach(r=>{s.current.removeLayer(r)}),p.current=[];let r=(r,e,t)=>a().divIcon({html:'\n          <div style="position: relative;">\n            <div style="background-color: '.concat(r,'; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; box-shadow: 0 4px 8px rgba(0,0,0,0.3); border: 3px solid white; font-size: 18px;">\n              ').concat(e,'\n            </div>\n            <div style="position: absolute; bottom: -8px; left: 50%; transform: translateX(-50%) translateY(100%); background-color: ').concat(r,'; padding: 2px 8px; border-radius: 4px; font-size: 12px; font-weight: bold; color: white; white-space: nowrap; box-shadow: 0 2px 4px rgba(0,0,0,0.2);">\n              ').concat(t,"\n            </div>\n          </div>\n        "),className:"",iconSize:[40,40],iconAnchor:[20,20],popupAnchor:[0,-20]}),n=[];if(i&&Array.isArray(i)&&2===i.length)try{let t=a().marker(i,{icon:r("#2563eb","\uD83D\uDCCD","D\xc9PART")}).addTo(s.current);e&&t.bindPopup('<div style="font-weight: bold; font-size: 14px;">\uD83D\uDCCD D\xe9part</div><div style="margin-top: 4px;">'.concat(e,"</div>"),{className:"custom-popup"}),p.current.push(t),n.push(i)}catch(r){console.error("[Map] Erreur cr\xe9ation marker d\xe9part:",r)}if(c&&Array.isArray(c)&&2===c.length)try{let e=a().marker(c,{icon:r("#10b981","\uD83C\uDFAF","ARRIV\xc9E")}).addTo(s.current);t&&e.bindPopup('<div style="font-weight: bold; font-size: 14px;">\uD83C\uDFAF Arriv\xe9e</div><div style="margin-top: 4px;">'.concat(t,"</div>"),{className:"custom-popup"}),p.current.push(e),n.push(c)}catch(r){console.error("[Map] Erreur cr\xe9ation marker arriv\xe9e:",r)}if(i&&c&&Array.isArray(i)&&Array.isArray(c)&&2===i.length&&2===c.length)try{let r=[i,c];a().polyline(r,{color:"#000000",weight:6,opacity:.2,smoothFactor:1}).addTo(s.current),l.current=a().polyline(r,{color:"#2563eb",weight:4,opacity:.8,dashArray:"12, 8",lineJoin:"round",lineCap:"round"}).addTo(s.current)}catch(r){console.error("[Map] Erreur lors du trac\xe9 de la route:",r)}n.length>0&&s.current?(s.current.invalidateSize(),requestAnimationFrame(()=>{if(s.current)try{if(1===n.length)s.current.setView(n[0],12,{animate:!0,duration:.5});else{let r=a().latLngBounds(n);s.current.fitBounds(r,{padding:[50,50],maxZoom:12,animate:!0,duration:.5})}}catch(r){console.error("[Map] Erreur ajustement vue:",r),s.current&&s.current.setView([46.603354,1.888334],6)}})):s.current&&requestAnimationFrame(()=>{if(s.current)try{s.current.invalidateSize(),s.current.setView([46.603354,1.888334],6,{animate:!0,duration:.5})}catch(r){console.error("[Map] Erreur setView France:",r)}})},[e,t,i,c]),(0,n.jsx)("div",{ref:h,className:"w-full h-full"})}t(966),t(2225)},2225:function(){},966:function(){}}]);